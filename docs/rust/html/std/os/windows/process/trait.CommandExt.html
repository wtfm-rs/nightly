<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Windows-specific extensions to the `process::Command` builder."><title>CommandExt in std::os::windows::process - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-0bd2dfd4.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="std" data-themes="" data-resource-suffix="1.95.0" data-rustdoc-version="1.95.0-nightly (e96bb7e44 2026-01-27)" data-channel="nightly" data-search-js="search-86d08462.js" data-stringdex-js="stringdex-b897f86f.js" data-settings-js="settings-170eb4bf.js" ><script src="../../../../static.files/storage-f9617a14.js"></script><script defer src="sidebar-items1.95.0.js"></script><script defer src="../../../../static.files/main-12f88f4f.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-ffcac47a.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><a class="skip-main-content" href="#main-content">Skip to main content</a><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">CommandExt</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../../std/index.html"><img class="rust-logo" src="../../../../static.files/rust-logo-9a9549ea.svg" alt="logo"></a><h2><a href="../../../../std/index.html">std</a><span class="version">1.95.0-nightly</span></h2></div><div class="version">(e96bb7e44	2026-01-27)</div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Command<wbr>Ext</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.async_pipes" title="async_pipes">async_pipes</a></li><li><a href="#tymethod.creation_flags" title="creation_flags">creation_flags</a></li><li><a href="#tymethod.force_quotes" title="force_quotes">force_quotes</a></li><li><a href="#tymethod.inherit_handles" title="inherit_handles">inherit_handles</a></li><li><a href="#tymethod.raw_arg" title="raw_arg">raw_arg</a></li><li><a href="#tymethod.show_window" title="show_window">show_window</a></li><li><a href="#tymethod.spawn_with_attributes" title="spawn_with_attributes">spawn_with_attributes</a></li><li><a href="#tymethod.startupinfo_force_feedback" title="startupinfo_force_feedback">startupinfo_force_feedback</a></li><li><a href="#tymethod.startupinfo_fullscreen" title="startupinfo_fullscreen">startupinfo_fullscreen</a></li><li><a href="#tymethod.startupinfo_untrusted_source" title="startupinfo_untrusted_source">startupinfo_untrusted_source</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In std::<wbr>os::<wbr>windows::<wbr>process</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content" tabindex="-1"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../index.html">std</a>::<wbr><a href="../../index.html">os</a>::<wbr><a href="../index.html">windows</a>::<wbr><a href="index.html">process</a></div><h1>Trait <span class="trait">Command<wbr>Ext</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><span class="since" title="Stable since Rust version 1.16.0">1.16.0</span> Â· <a class="src" href="../../../../src/std/os/windows/process.rs.html#175-382">Source</a> </span></div><pre class="rust item-decl"><code>pub trait CommandExt: Sealed {
    // Required methods
    fn <a href="#tymethod.creation_flags" class="fn">creation_flags</a>(&amp;mut self, flags: <a class="primitive" href="../../../primitive.u32.html">u32</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.show_window" class="fn">show_window</a>(&amp;mut self, cmd_show: <a class="primitive" href="../../../primitive.u16.html">u16</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.force_quotes" class="fn">force_quotes</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.raw_arg" class="fn">raw_arg</a>&lt;S: <a class="trait" href="../../../convert/trait.AsRef.html" title="trait std::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../../../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;&gt;(
        &amp;mut self,
        text_to_append_as_is: S,
    ) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.async_pipes" class="fn">async_pipes</a>(&amp;mut self, always_async: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.spawn_with_attributes" class="fn">spawn_with_attributes</a>(
        &amp;mut self,
        attribute_list: &amp;<a class="struct" href="struct.ProcThreadAttributeList.html" title="struct std::os::windows::process::ProcThreadAttributeList">ProcThreadAttributeList</a>&lt;'_&gt;,
    ) -&gt; <a class="type" href="../../../io/type.Result.html" title="type std::io::Result">Result</a>&lt;<a class="struct" href="../../../process/struct.Child.html" title="struct std::process::Child">Child</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.startupinfo_fullscreen" class="fn">startupinfo_fullscreen</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.startupinfo_untrusted_source" class="fn">startupinfo_untrusted_source</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.startupinfo_force_feedback" class="fn">startupinfo_force_feedback</a>(
        &amp;mut self,
        enabled: <a class="enum" href="../../../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;<a class="primitive" href="../../../primitive.bool.html">bool</a>&gt;,
    ) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.inherit_handles" class="fn">inherit_handles</a>(&amp;mut self, inherit_handles: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a>;
}</code></pre><span class="item-info"><div class="stab portability">Available on <strong>Windows</strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Windows-specific extensions to the <a href="../../../process/struct.Command.html" title="struct std::process::Command"><code>process::Command</code></a> builder.</p>
<p>This trait is sealed: it cannot be implemented outside the standard library.
This is so that future additional methods are not breaking changes.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">Â§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.creation_flags" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.16.0">1.16.0</span> Â· <a class="src" href="../../../../src/std/os/windows/process.rs.html#182">Source</a></span><h4 class="code-header">fn <a href="#tymethod.creation_flags" class="fn">creation_flags</a>(&amp;mut self, flags: <a class="primitive" href="../../../primitive.u32.html">u32</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section></summary><div class="docblock"><p>Sets the <a href="https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags">process creation flags</a> to be passed to <code>CreateProcess</code>.</p>
<p>These will always be ORed with <code>CREATE_UNICODE_ENVIRONMENT</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.show_window" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#190">Source</a><h4 class="code-header">fn <a href="#tymethod.show_window" class="fn">show_window</a>(&amp;mut self, cmd_show: <a class="primitive" href="../../../primitive.u16.html">u16</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_show_window</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/127544">#127544</a>)</span></div></span></summary><div class="docblock"><p>Sets the field <code>wShowWindow</code> of <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfow">STARTUPINFO</a> that is passed to <code>CreateProcess</code>.
Allowed values are the ones listed in
<a href="https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-showwindow">https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-showwindow</a></p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.force_quotes" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#206">Source</a><h4 class="code-header">fn <a href="#tymethod.force_quotes" class="fn">force_quotes</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_force_quotes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/82227">#82227</a>)</span></div></span></summary><div class="docblock"><p>Forces all arguments to be wrapped in quote (<code>"</code>) characters.</p>
<p>This is useful for passing arguments to <a href="https://github.com/msys2/MSYS2-packages/issues/2176">MSYS2/Cygwin</a> based
executables: these programs will expand unquoted arguments containing
wildcard characters (<code>?</code> and <code>*</code>) by searching for any file paths
matching the wildcard pattern.</p>
<p>Adding quotes has no effect when passing arguments to programs
that use <a href="https://msdn.microsoft.com/en-us/library/17w5ykft.aspx">msvcrt</a>. This includes programs built with both
MinGW and MSVC.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.raw_arg" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.62.0">1.62.0</span> Â· <a class="src" href="../../../../src/std/os/windows/process.rs.html#266">Source</a></span><h4 class="code-header">fn <a href="#tymethod.raw_arg" class="fn">raw_arg</a>&lt;S: <a class="trait" href="../../../convert/trait.AsRef.html" title="trait std::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../../../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;&gt;(&amp;mut self, text_to_append_as_is: S) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section></summary><div class="docblock"><p>Append literal text to the command line without any quoting or escaping.</p>
<p>This is useful for passing arguments to applications that donâ€™t follow
the standard C run-time escaping rules, such as <code>cmd.exe /c</code>.</p>
<h5 id="batch-files"><a class="doc-anchor" href="#batch-files">Â§</a>Batch files</h5>
<p>Note the <code>cmd /c</code> command line has slightly different escaping rules than batch files
themselves. If possible, it may be better to write complex arguments to a temporary
<code>.bat</code> file, with appropriate escaping, and simply run that using:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>output = Command::new(<span class="string">"cmd"</span>).args([<span class="string">"/c"</span>, <span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">"\"{temp_bat_file}\""</span>)]).output();</code></pre><a class="test-arrow" target="_blank" title="Run code" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A++++use+std::process::Command;%0A++++let+temp_bat_file+=+%22%22;%0A++++%23%5Ballow(unused)%5D%0A++++let+output+=+Command::new(%22cmd%22).args(%5B%22/c%22,+%26format!(%22%5C%22%7Btemp_bat_file%7D%5C%22%22)%5D).output();%0A%7D&amp;edition=2024"></a></div><h5 id="example"><a class="doc-anchor" href="#example">Â§</a>Example</h5>
<p>Run a batch script using both trusted and untrusted arguments.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#[cfg(windows)]
</span><span class="comment">// `my_script_path` is a path to known bat file.
// `user_name` is an untrusted name given by the user.
</span><span class="kw">fn </span>run_script(
    my_script_path: <span class="kw-2">&amp;</span>str,
    user_name: <span class="kw-2">&amp;</span>str,
) -&gt; <span class="prelude-ty">Result</span>&lt;std::process::Output, std::io::Error&gt; {
    <span class="kw">use </span>std::io::{Error, ErrorKind};
    <span class="kw">use </span>std::os::windows::process::CommandExt;
    <span class="kw">use </span>std::process::Command;

    <span class="comment">// Create the command line, making sure to quote the script path.
    // This assumes the fixed arguments have been tested to work with the script we're using.
    </span><span class="kw">let </span><span class="kw-2">mut </span>cmd_args = <span class="macro">format!</span>(<span class="string">r#""{my_script_path}" "--features=[a,b,c]""#</span>);

    <span class="comment">// Make sure the user name is safe. In particular we need to be
    // cautious of ascii symbols that cmd may interpret specially.
    // Here we only allow alphanumeric characters.
    </span><span class="kw">if </span>!user_name.chars().all(|c| c.is_alphanumeric()) {
        <span class="kw">return </span><span class="prelude-val">Err</span>(Error::new(ErrorKind::InvalidInput, <span class="string">"invalid user name"</span>));
    }

    <span class="comment">// now we have validated the user name, let's add that too.
    </span>cmd_args.push_str(<span class="string">" --user "</span>);
    cmd_args.push_str(user_name);

    <span class="comment">// call cmd.exe and return the output
    </span>Command::new(<span class="string">"cmd.exe"</span>)
        .arg(<span class="string">"/c"</span>)
        <span class="comment">// surround the entire command in an extra pair of quotes, as required by cmd.exe.
        </span>.raw_arg(<span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">"\"{cmd_args}\""</span>))
        .output()
}</code></pre><a class="test-arrow" target="_blank" title="Run code" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A++++%23%5Bcfg(windows)%5D%0A++++//+%60my_script_path%60+is+a+path+to+known+bat+file.%0A++++//+%60user_name%60+is+an+untrusted+name+given+by+the+user.%0A++++fn+run_script(%0A++++++++my_script_path:+%26str,%0A++++++++user_name:+%26str,%0A++++)+-%3E+Result%3Cstd::process::Output,+std::io::Error%3E+%7B%0A++++++++use+std::io::%7BError,+ErrorKind%7D;%0A++++++++use+std::os::windows::process::CommandExt;%0A++++++++use+std::process::Command;%0A++++%0A++++++++//+Create+the+command+line,+making+sure+to+quote+the+script+path.%0A++++++++//+This+assumes+the+fixed+arguments+have+been+tested+to+work+with+the+script+we're+using.%0A++++++++let+mut+cmd_args+=+format!(r%23%22%22%7Bmy_script_path%7D%22+%22--features=%5Ba,b,c%5D%22%22%23);%0A++++%0A++++++++//+Make+sure+the+user+name+is+safe.+In+particular+we+need+to+be%0A++++++++//+cautious+of+ascii+symbols+that+cmd+may+interpret+specially.%0A++++++++//+Here+we+only+allow+alphanumeric+characters.%0A++++++++if+!user_name.chars().all(%7Cc%7C+c.is_alphanumeric())+%7B%0A++++++++++++return+Err(Error::new(ErrorKind::InvalidInput,+%22invalid+user+name%22));%0A++++++++%7D%0A++++%0A++++++++//+now+we+have+validated+the+user+name,+let's+add+that+too.%0A++++++++cmd_args.push_str(%22+--user+%22);%0A++++++++cmd_args.push_str(user_name);%0A++++%0A++++++++//+call+cmd.exe+and+return+the+output%0A++++++++Command::new(%22cmd.exe%22)%0A++++++++++++.arg(%22/c%22)%0A++++++++++++//+surround+the+entire+command+in+an+extra+pair+of+quotes,+as+required+by+cmd.exe.%0A++++++++++++.raw_arg(%26format!(%22%5C%22%7Bcmd_args%7D%5C%22%22))%0A++++++++++++.output()%0A++++%7D%0A%7D&amp;edition=2024"></a></div></div></details><details class="toggle method-toggle" open><summary><section id="tymethod.async_pipes" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#297">Source</a><h4 class="code-header">fn <a href="#tymethod.async_pipes" class="fn">async_pipes</a>(&amp;mut self, always_async: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_async_pipes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/98289">#98289</a>)</span></div></span></summary><div class="docblock"><p>When <a href="../../../process/struct.Command.html" title="struct std::process::Command"><code>process::Command</code></a> creates pipes, request that our side is always async.</p>
<p>By default <a href="../../../process/struct.Command.html" title="struct std::process::Command"><code>process::Command</code></a> may choose to use pipes where both ends
are opened for synchronous read or write operations. By using
<code>async_pipes(true)</code>, this behavior is overridden so that our side is
always async.</p>
<p>This is important because if doing async I/O a pipe or a file has to be
opened for async access.</p>
<p>The end of the pipe sent to the child process will always be synchronous
regardless of this option.</p>
<h5 id="example-1"><a class="doc-anchor" href="#example-1">Â§</a>Example</h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(windows_process_extensions_async_pipes)]
</span><span class="kw">use </span>std::os::windows::process::CommandExt;
<span class="kw">use </span>std::process::{Command, Stdio};


Command::new(program)
    .async_pipes(<span class="bool-val">true</span>)
    .stdin(Stdio::piped())
    .stdout(Stdio::piped())
    .stderr(Stdio::piped());</code></pre><a class="test-arrow" target="_blank" title="Run code" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(windows_process_extensions_async_pipes)%5D%0A%0Afn+main()+%7B%0A++++use+std::os::windows::process::CommandExt;%0A++++use+std::process::%7BCommand,+Stdio%7D;%0A++++%0A++++let+program+=+%22%22;%0A++++%0A++++Command::new(program)%0A++++++++.async_pipes(true)%0A++++++++.stdin(Stdio::piped())%0A++++++++.stdout(Stdio::piped())%0A++++++++.stderr(Stdio::piped());%0A%7D&amp;version=nightly&amp;edition=2024"></a></div></div></details><details class="toggle method-toggle" open><summary><section id="tymethod.spawn_with_attributes" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#343-346">Source</a><h4 class="code-header">fn <a href="#tymethod.spawn_with_attributes" class="fn">spawn_with_attributes</a>(
    &amp;mut self,
    attribute_list: &amp;<a class="struct" href="struct.ProcThreadAttributeList.html" title="struct std::os::windows::process::ProcThreadAttributeList">ProcThreadAttributeList</a>&lt;'_&gt;,
) -&gt; <a class="type" href="../../../io/type.Result.html" title="type std::io::Result">Result</a>&lt;<a class="struct" href="../../../process/struct.Child.html" title="struct std::process::Child">Child</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_raw_attribute</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/114854">#114854</a>)</span></div></span></summary><div class="docblock"><p>Executes the command as a child process with the given
<a href="struct.ProcThreadAttributeList.html" title="struct std::os::windows::process::ProcThreadAttributeList"><code>ProcThreadAttributeList</code></a>, returning a handle to it.</p>
<p>This method enables the customization of attributes for the spawned
child process on Windows systems.
Attributes offer extended configurability for process creation,
but their usage can be intricate and potentially unsafe.</p>
<h5 id="note"><a class="doc-anchor" href="#note">Â§</a>Note</h5>
<p>By default, stdin, stdout, and stderr are inherited from the parent
process.</p>
<h5 id="example-2"><a class="doc-anchor" href="#example-2">Â§</a>Example</h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(windows_process_extensions_raw_attribute)]
</span><span class="kw">use </span>std::os::windows::io::AsRawHandle;
<span class="kw">use </span>std::os::windows::process::{CommandExt, ProcThreadAttributeList};
<span class="kw">use </span>std::process::Command;

<span class="kw">let </span>parent = Command::new(<span class="string">"cmd"</span>).spawn()<span class="question-mark">?</span>;
<span class="kw">let </span>parent_process_handle = parent.as_raw_handle();

<span class="kw">const </span>PROC_THREAD_ATTRIBUTE_PARENT_PROCESS: usize = <span class="number">0x00020000</span>;
<span class="kw">let </span><span class="kw-2">mut </span>attribute_list = ProcThreadAttributeList::build()
    .attribute(PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, <span class="kw-2">&amp;</span>parent_process_handle)
    .finish()
    .unwrap();

<span class="kw">let </span><span class="kw-2">mut </span>child = Command::new(<span class="string">"cmd"</span>).spawn_with_attributes(<span class="kw-2">&amp;</span>attribute_list)<span class="question-mark">?</span>;</code></pre><a class="test-arrow" target="_blank" title="Run code" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(windows_process_extensions_raw_attribute)%5D%0A%0Afn+main()+%7B+fn+_inner()+-%3E+core::result::Result%3C(),+impl+core::fmt::Debug%3E+%7B%0A++++use+std::os::windows::io::AsRawHandle;%0A++++use+std::os::windows::process::%7BCommandExt,+ProcThreadAttributeList%7D;%0A++++use+std::process::Command;%0A++++%0A++++struct+ProcessDropGuard(std::process::Child);%0A++++impl+Drop+for+ProcessDropGuard+%7B%0A++++++++fn+drop(%26mut+self)+%7B%0A++++++++++++let+_+=+self.0.kill();%0A++++++++%7D%0A++++%7D%0A++++%0A++++let+parent+=+Command::new(%22cmd%22).spawn()?;%0A++++let+parent_process_handle+=+parent.as_raw_handle();%0A++++let+parent+=+ProcessDropGuard(parent);%0A++++%0A++++const+PROC_THREAD_ATTRIBUTE_PARENT_PROCESS:+usize+=+0x00020000;%0A++++let+mut+attribute_list+=+ProcThreadAttributeList::build()%0A++++++++.attribute(PROC_THREAD_ATTRIBUTE_PARENT_PROCESS,+%26parent_process_handle)%0A++++++++.finish()%0A++++++++.unwrap();%0A++++%0A++++let+mut+child+=+Command::new(%22cmd%22).spawn_with_attributes(%26attribute_list)?;%0A++++%0A++++child.kill()?;%0A++++Ok::%3C(),+std::io::Error%3E(())%0A%7D+_inner().unwrap()+%7D&amp;version=nightly&amp;edition=2024"></a></div></div></details><details class="toggle method-toggle" open><summary><section id="tymethod.startupinfo_fullscreen" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#352">Source</a><h4 class="code-header">fn <a href="#tymethod.startupinfo_fullscreen" class="fn">startupinfo_fullscreen</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_startupinfo</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/141010">#141010</a>)</span></div></span></summary><div class="docblock"><p>When true, sets the <code>STARTF_RUNFULLSCREEN</code> flag on the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa">STARTUPINFO</a> struct before passing it to <code>CreateProcess</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.startupinfo_untrusted_source" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#358">Source</a><h4 class="code-header">fn <a href="#tymethod.startupinfo_untrusted_source" class="fn">startupinfo_untrusted_source</a>(&amp;mut self, enabled: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_startupinfo</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/141010">#141010</a>)</span></div></span></summary><div class="docblock"><p>When true, sets the <code>STARTF_UNTRUSTEDSOURCE</code> flag on the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa">STARTUPINFO</a> struct before passing it to <code>CreateProcess</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.startupinfo_force_feedback" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#367">Source</a><h4 class="code-header">fn <a href="#tymethod.startupinfo_force_feedback" class="fn">startupinfo_force_feedback</a>(&amp;mut self, enabled: <a class="enum" href="../../../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;<a class="primitive" href="../../../primitive.bool.html">bool</a>&gt;) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_startupinfo</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/141010">#141010</a>)</span></div></span></summary><div class="docblock"><p>When specified, sets the following flags on the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa">STARTUPINFO</a> struct before passing it to <code>CreateProcess</code>:</p>
<ul>
<li>If <code>Some(true)</code>, sets <code>STARTF_FORCEONFEEDBACK</code></li>
<li>If <code>Some(false)</code>, sets <code>STARTF_FORCEOFFFEEDBACK</code></li>
<li>If <code>None</code>, does not set any flags</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.inherit_handles" class="method"><a class="src rightside" href="../../../../src/std/os/windows/process.rs.html#381">Source</a><h4 class="code-header">fn <a href="#tymethod.inherit_handles" class="fn">inherit_handles</a>(&amp;mut self, inherit_handles: <a class="primitive" href="../../../primitive.bool.html">bool</a>) -&gt; &amp;mut <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>windows_process_extensions_inherit_handles</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/146407">#146407</a>)</span></div></span></summary><div class="docblock"><p>If this flag is set to <code>true</code>, each inheritable handle in the calling
process is inherited by the new process. If the flag is <code>false</code>, the
handles are not inherited.</p>
<p>The default value for this flag is <code>true</code>.</p>
<p><strong>Note</strong> that inherited handles have the same value and access rights
as the original handles. For additional discussion of inheritable handles,
see the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw#remarks">Remarks</a> section of the <code>CreateProcessW</code> documentation.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">Â§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">Â§</a></h2><div id="implementors-list"><div class="negative-marker"></div><section id="impl-CommandExt-for-Command" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.16.0">1.16.0</span> Â· <a class="src" href="../../../../src/std/os/windows/process.rs.html#385-443">Source</a></span><a href="#impl-CommandExt-for-Command" class="anchor">Â§</a><h3 class="code-header">impl <a class="trait" href="trait.CommandExt.html" title="trait std::os::windows::process::CommandExt">CommandExt</a> for <a class="struct" href="../../../process/struct.Command.html" title="struct std::process::Command">Command</a></h3></section></div><script src="../../../../trait.impl/std/os/windows/process/trait.CommandExt.js" async></script></section></div></main></body></html>